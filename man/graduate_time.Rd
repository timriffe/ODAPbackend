% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graduation.R
\name{graduate_time}
\alias{graduate_time}
\title{Graduate grouped time data to single-year estimates
Expands grouped time data (e.g., 5-year intervals) into single-year values using various graduation methods. The function supports smoothing, monotone interpolation, uniform splitting, cubic regression splines, penalized composite link models (PCLM), and LOESS smoothing.}
\usage{
graduate_time(
  data_in,
  method = c("loess", "smooth_spline", "cubic", "mono", "uniform", "pclm"),
  X,
  Y,
  timeInt = 5
)
}
\arguments{
\item{data_in}{Data frame containing grouped time data.}

\item{method}{Graduation method. One of \code{"loess"}, \code{"smooth_spline"}, \code{"cubic"}, \code{"mono"}, \code{"uniform"}, \code{"pclm"}.}

\item{X}{Name of the time variable (character string).}

\item{Y}{Name of the grouped value variable (character string).}

\item{timeInt}{Width of grouping interval (default = 5).}
}
\value{
A data frame with columns:
\itemize{
\item \code{time} — single-year time values
\item \code{value} — graduated single-year estimates
\item \code{.id} — subgroup identifier
}
}
\description{
Available methods:
\itemize{
\item \code{"uniform"} — distributes totals evenly within each interval
\item \code{"mono"} — monotone cubic interpolation (Hyman filtered spline)
\item \code{"smooth_spline"} — smoothing spline via \code{stats::smooth.spline}
\item \code{"cubic"} — cubic regression spline via \code{mgcv::gam}
\item \code{"loess"} — local polynomial smoothing via \code{stats::loess}
\item \code{"pclm"} — penalized composite link model via \code{ungroup::pclm}
}
}
\details{
Block totals are preserved for all smoothing-based methods by rescaling
predictions within each interval to match original grouped totals.

If column \code{.id} exists in \code{data_in}, graduation is performed separately within each subgroup. Otherwise all observations are treated as a single group.
For spline-based methods, predicted single-year values are rescaled
within each interval so that grouped totals are exactly preserved.
The PCLM method relies on the \pkg{ungroup} package and may internally rescale small counts to avoid negative fitted values.
}
\examples{
df <- data.frame(
  Year   = seq(1950, 2015, by = 5),
  Deaths = c(403564.9, 426012.0, 466215.9, 523753.8, 560874.1,
             545608.3, 555335.9, 594584.6, 608425.3, 638167.3,
             655438.6, 689386.4, 740519.0, 804439.3)
)

graduate_time(
  df,
  method = "pclm",
  X = "Year",
  Y = "Deaths",
  timeInt = 5
)

}
