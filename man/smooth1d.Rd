% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smoothing1d.R
\name{smooth1d}
\alias{smooth1d}
\title{One–Dimensional Smoothing Wrapper for Age or Time Series
\code{smooth1d()} provides a unified interface for smoothing one–dimensional demographic or time–series data (e.g., age schedules or time trends).
The function supports multiple smoothing engines including \code{supsmu}, \code{lowess}, \code{loess}, cubic splines, and GAM-based methods.
Optional transformations (log, sqrt, logit) can be applied prior to smoothing.
The function automatically handles grouped data via a \code{.id} column.}
\usage{
smooth1d(
  data_in,
  units = c("count", "rate", "proportion"),
  X = c("Age", "Time"),
  Y = c("Exposures"),
  scale = c("log", "sqrt", "logit", "none"),
  method = c("supsmu", "lowess", "loess", "cubicspline", "gam-tp", "gam-ps"),
  smoothing_par = 1,
  xout = unique(data_in[[X]])
)
}
\arguments{
\item{data_in}{A data.frame or tibble containing the input data.}

\item{units}{Character string. One of:
\itemize{
\item \code{"count"}
\item \code{"rate"}
\item \code{"proportion"}
}}

\item{X}{Character string. Name of the independent variable (typically \code{"Age"} or \code{"Time"}).}

\item{Y}{Character string. Name of the dependent variable.}

\item{scale}{Optional transformation applied before smoothing:
\itemize{
\item \code{"log"}
\item \code{"sqrt"}
\item \code{"logit"}
\item \code{"none"}
}}

\item{method}{Smoothing engine:
\itemize{
\item \code{"supsmu"}
\item \code{"lowess"}
\item \code{"loess"}
\item \code{"cubicspline"}
\item \code{"gam-tp"} (thin plate regression spline)
\item \code{"gam-ps"} (P-spline)
}}

\item{smoothing_par}{Numeric smoothing parameter. Interpretation depends on method.}

\item{xout}{Optional vector of evaluation points. Defaults to unique values of \code{X}.}
}
\value{
A named list with:
\itemize{
\item \code{result} — Tibble containing smoothed values
\item \code{plot} — ggplot object comparing raw and smoothed values
}
}
\description{
One–Dimensional Smoothing Wrapper for Age or Time Series
\code{smooth1d()} provides a unified interface for smoothing one–dimensional demographic or time–series data (e.g., age schedules or time trends).
The function supports multiple smoothing engines including \code{supsmu}, \code{lowess}, \code{loess}, cubic splines, and GAM-based methods.
Optional transformations (log, sqrt, logit) can be applied prior to smoothing.
The function automatically handles grouped data via a \code{.id} column.
}
\details{
If the input data does not contain a \code{.id} column, a default group \code{"all"} is created.
Weights default to 1 if not supplied.
Transformations are applied before smoothing but not automatically back-transformed.
}
\examples{
# Example 1: Age smoothing of mortality rates (log scale)
library(readr)

fpath <- system.file(
  "extdata",
  "single_hmd_spain.csv.gz",
  package = "ODAPbackend"
)

data_in <- read_csv(fpath, col_select = c(-1), show_col_types = FALSE)
data_in$nMx <- data_in$Deaths / data_in$Exposures
data_in <- data_in[data_in$.id == 1, ]
names(data_in) <- c(".id", "Time", "Age", "Sex",
                    "Deaths", "Exposures", "nMx")

z <- smooth1d(
  data_in = data_in,
  units   = "rate",
  X       = "Age",
  Y       = "nMx",
  method  = "supsmu",
  scale   = "log"
)

z$result
z$plot

# Example 2: Time smoothing of counts
df <- data.frame(
  Time   = seq(1950, 2015, by = 5),
  Deaths = c(403564.9, 426012.0, 466215.9, 523753.8,
             560874.1, 545608.3, 555335.9, 594584.6,
             608425.3, 638167.3, 655438.6, 689386.4,
             740519.0, 804439.3)
)

z <- smooth1d(
  data_in = df,
  units   = "count",
  X       = "Time",
  Y       = "Deaths",
  method  = "supsmu",
  scale   = "none"
)

z$result
z$plot

}
